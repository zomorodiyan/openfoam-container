Bootstrap: docker
From: zomorodiyan/openfoam10:mpich-jun11

%post
    # Make sure bash is default shell, but safely
    ln -sf /bin/bash /bin/sh

    # Optional: Add any additional tools here (uncomment as needed)
    # apt-get update && apt-get install -y nano htop

%environment
    # Explicitly set OpenFOAM environment
    export FOAM_INST_DIR=/opt/OpenFOAM
    export WM_PROJECT_DIR=/opt/OpenFOAM/OpenFOAM-10
    export PATH=$WM_PROJECT_DIR/bin:$PATH
    export LD_LIBRARY_PATH=$WM_PROJECT_DIR/lib:$LD_LIBRARY_PATH

%runscript
    # Source OpenFOAM environment correctly for any command passed in
    export FOAM_INST_DIR=/opt/OpenFOAM
    export WM_PROJECT_DIR=$FOAM_INST_DIR/OpenFOAM-10
    source $WM_PROJECT_DIR/etc/bashrc
    exec "$@"
